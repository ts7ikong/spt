<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.sptsjzx.qyaqjcgl.zysbsssj.jcsbxx.sbxx.mapper.DeviceBaseInfoMapper">

    <select id="getDeviceTypeStats" resultType="java.util.HashMap">
        SELECT
        COUNT(*) AS value,
        d.equip_type AS name
        FROM device_base_info d
        LEFT JOIN accept_company c ON d.company_code = c.code
        WHERE 1=1
        <if test="countycode != null and countycode != ''">
            AND c.countycode = #{countycode}
        </if>
        <if test="yqType != null">
            AND c.yq_type = #{yqType}
        </if>
        <if test="companyCode != null and companyCode != ''">
            AND d.company_code = #{companyCode}
        </if>
        <if test="isScqy != null">
            AND c.is_scqy = #{isScqy}
        </if>
        GROUP BY d.equip_type
        ORDER BY value DESC
    </select>

</mapper>